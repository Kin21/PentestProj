from anytree import NodeMixin, RenderTree
from anytree.exporter.dotexporter import UniqueDotExporter


class CWE(NodeMixin):
    def __init__(self, name, parent=None, children=None):
        self.name = name
        self.parent = parent
        if children:
            self.children = children


class CVE(CWE):
    def __init__(self, name, parent=None, children=None):
        super().__init__(name, parent, children)

class Requirement(CWE):
    def __init__(self, name, parent=None, children=None):
        super().__init__(name, parent, children)


CWE1003 = CWE('CWE-1003', parent=None)
CWE707 = CWE('CWE-707', parent=CWE1003)
CWE74 = CWE('CWE-74', parent=CWE707)
CWE77 = CWE('CWE-77', parent=CWE74)
CWE78 = CWE('CWE-78', parent=CWE77)
CVE20112523 = CVE('CVE-2011-2523', parent=CWE78)
r1 = Requirement('Port:21', parent=CVE20112523)
r2 = Requirement('FTP:vsftpd 2.3.4.', parent=CVE20112523)

CWE310 = CWE('CWE310', parent=CWE1003)
CVE20080166 = CVE('CVE-2008-0166 ', parent=CWE310)
r3 = Requirement('Port:22', parent=CVE20080166)
r4 = Requirement('SSH', parent=CVE20080166)
r5 = Requirement('OpenSSL<0.9.8g-9', parent=CVE20080166)

CWE691 = CWE('CWE-691', parent=CWE1003)
CWE799 = CWE('CWE-799', parent=CWE691)
CWE307 = CWE('CWE-307', parent=CWE799)
CVE20073279 = CVE('CVE-2007-3279', parent=CWE307)
CVE20010471 = CVE('CVE-2001-0471', parent=CWE307)

r6 = Requirement('Port:22', parent=CVE20010471)
r7 = Requirement('SSH', parent=CVE20010471)
r8 = Requirement('Port:5432', parent=CVE20073279)
r9 = Requirement('PostgreSQL', parent=CVE20073279)



UniqueDotExporter(CWE1003).to_picture('test.dot')